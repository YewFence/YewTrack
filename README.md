# YewTrack æ¶ˆæ¯ä¼ è¾“ç½‘é¡µåº”ç”¨

ä¸€ä¸ªåŸºäº Vue 3 + Express çš„è·¨è®¾å¤‡æ¶ˆæ¯å’Œæ–‡ä»¶ä¼ è¾“ç½‘é¡µåº”ç”¨ã€‚

## ğŸ¯ é¡¹ç›®èƒŒæ™¯
å› ä¸ºæˆ‘æƒ³è¦ä¸€ä¸ªç®€å•è½»é‡çš„å·¥å…·ï¼Œåœ¨tailscaleç½‘å†…çš„ä¸åŒè®¾å¤‡é—´ä¼ è¾“**æ–‡æœ¬æ¶ˆæ¯**å’Œ**æ–‡ä»¶**ï¼Œæ­£å¥½æˆ‘æœ‰ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå°±å½“æ˜¯å­¦ä¹ Typescriptsäº†

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- ğŸ“ **æ–‡æœ¬æ¶ˆæ¯å‘é€** - å¿«é€Ÿå®æ—¶å‘é€å’Œæ¥æ”¶æ–‡æœ¬æ¶ˆæ¯
- ğŸ“ **æ–‡ä»¶ä¼ è¾“** - æ”¯æŒå¤§æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼ˆé»˜è®¤æœ€å¤§ 500MBï¼‰
- ğŸ–¼ï¸ **å¤šåª’ä½“é¢„è§ˆ** - å›¾ç‰‡ã€è§†é¢‘åœ¨çº¿é¢„è§ˆ
  - å›¾ç‰‡æ”¯æŒç‚¹å‡»æ”¾å¤§æŸ¥çœ‹
  - è§†é¢‘æ”¯æŒåœ¨çº¿æ’­æ”¾
- ğŸ’¬ **æ¶ˆæ¯è‡ªåŠ¨åŒæ­¥** - åŸºäºWebsocketçš„æ¶ˆæ¯åŒæ­¥åŠŸèƒ½
- ğŸ”„ **æ‰‹åŠ¨åˆ·æ–°** - é¡¶éƒ¨å·¥å…·æ åˆ·æ–°æŒ‰é’®æ‰‹åŠ¨ç«‹å³åŒæ­¥æ¶ˆæ¯
- ğŸ—‘ï¸ **æ¶ˆæ¯åˆ é™¤** - ç‚¹å‡»åˆ é™¤æŒ‰é’®æ‰‹åŠ¨åˆ é™¤æŒ‡å®šæ¶ˆæ¯
- ğŸ“… **æ™ºèƒ½æ—¶é—´æ˜¾ç¤º** - æ˜¾ç¤ºæ¶ˆæ¯å‘é€æ—¶é—´/æ—¥æœŸ
- ğŸ“ƒ **è‡ªåŠ¨è½®è½¬åˆ é™¤** - è¶…è¿‡ä¿ç•™æœŸé™çš„æ¶ˆæ¯å’Œæ–‡ä»¶è‡ªåŠ¨æ¸…ç†

### UI ç‰¹æ€§
- ğŸ¨ **ç°ä»£åŒ–ç•Œé¢** - åŸºäº Tailwind CSS çš„ç®€æ´è®¾è®¡
- ğŸ“± **å“åº”å¼å¸ƒå±€** - é€‚é…æ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
- ğŸ†” **è®¾å¤‡è¯†åˆ«** - åŸºäº localStorage çš„å”¯ä¸€è®¾å¤‡ ID
- â†”ï¸ **æ¶ˆæ¯å¯¹é½** - æœ¬è®¾å¤‡æ¶ˆæ¯å³å¯¹é½ï¼Œå…¶ä»–è®¾å¤‡å·¦å¯¹é½
- ğŸ” **å›ºå®šé¡¶æ ** - æ ‡é¢˜å’Œåˆ·æ–°æŒ‰é’®å›ºå®šåœ¨é¡¶éƒ¨
- ğŸ“ **å›ºå®šè¾“å…¥æ ** - è¾“å…¥æ¡†å’Œå‘é€æŒ‰é’®å›ºå®šåœ¨åº•éƒ¨
- ğŸ–¼ï¸ **æ–‡ä»¶é¢„è§ˆ** - å›¾ç‰‡/è§†é¢‘æ¶ˆæ¯æ˜¾ç¤ºç¼©ç•¥å›¾å’Œæ’­æ”¾å™¨
- ğŸ“¥ **ä¸‹è½½æŒ‰é’®** - æ–‡ä»¶æ¶ˆæ¯æä¾›ç‹¬ç«‹ä¸‹è½½æŒ‰é’®

### æ•°æ®ç®¡ç†
- ğŸ’¾ **JSONL å­˜å‚¨** - è½»é‡çº§æ¶ˆæ¯æŒä¹…åŒ–æ–¹æ¡ˆ
- ğŸ—‚ï¸ **æ–‡ä»¶åˆ†ç¦»å­˜å‚¨** - æ–‡ä»¶ç‹¬ç«‹ä¿å­˜åœ¨ `data/files/` ç›®å½•
  - `original/` - åŸå§‹æ–‡ä»¶
  - `preview/` - é¢„è§ˆç¼©ç•¥å›¾ï¼ˆæœªæ¥åŠŸèƒ½ï¼‰
- ğŸ”„ **æ™ºèƒ½æ¸…ç†ç­–ç•¥**ï¼ˆå¯é…ç½®ï¼‰ï¼š
  - å¤§æ–‡ä»¶ï¼ˆ>100MBï¼‰é»˜è®¤ä¿ç•™ 1 å¤©
  - å°æ–‡ä»¶ï¼ˆâ‰¤100MBï¼‰é»˜è®¤ä¿ç•™ 7 å¤©
  - æ–‡æœ¬æ¶ˆæ¯é»˜è®¤ä¿ç•™ 30 å¤©
- ğŸ• **å®šæ—¶ä»»åŠ¡** - é»˜è®¤æ¯å°æ—¶è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®
- ğŸ”’ **æ•°æ®æŒä¹…åŒ–** - æ•°æ®ç›®å½•æŒ‚è½½åˆ°å®¿ä¸»æœºï¼Œé‡å¯ä¸ä¸¢å¤±

## ğŸš€ å¿«é€Ÿå¼€å§‹

## æœ¬åœ°å¼€å‘

### å‰ç½®è¦æ±‚
- Node.js 20+
- pnpm 10+

### å®‰è£…ä¾èµ–

```bash

# å®‰è£…å‰åç«¯ä¾èµ–
cd frontend;pnpm install
cd ../backend;pnpm install
```

### å¼€å‘æ¨¡å¼

```bash
# å¯åŠ¨åç«¯ï¼ˆç«¯å£ 3000ï¼‰
cd backend
pnpm run dev

# å¯åŠ¨å‰ç«¯ï¼ˆç«¯å£ 5173ï¼‰
cd frontend
pnpm run dev
```

è®¿é—® `http://localhost:5173` å³å¯ä½¿ç”¨ã€‚

### ç”Ÿäº§éƒ¨ç½²ï¼ˆDockerï¼‰

#### ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹
â— æœ¬åº”ç”¨æœªå®ç°ç”¨æˆ·è®¤è¯ï¼Œ**ä»…é€‚ç”¨äºå±€åŸŸç½‘æˆ–å—ä¿¡ä»»çš„ç¯å¢ƒ**ï¼Œåˆ‡å‹¿éƒ¨ç½²ä¸Šå…¬ç½‘
> æˆ‘ä¸ªäººæ˜¯åœ¨ [Tailscale](https://tailscale.com) çš„ä¸€ä¸ªå§‹ç»ˆåœ¨çº¿çš„è®¾å¤‡ä¸Šä½¿ç”¨ Docker è¿è¡Œçš„ï¼Œé€šè¿‡é…ç½®[tailscale serve](https://tailscale.com/kb/1312/serve)è®©åŒä¸€ä¸ªtailnetä¸‹çš„è®¾å¤‡å¯ä»¥é€šè¿‡MagicDNSè®¿é—®ï¼Œéå¸¸æ–¹ä¾¿ã€‚


```bash
# æ„å»ºå¹¶å¯åŠ¨å®¹å™¨
docker-compose up -d --build

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢å®¹å™¨
docker-compose down
```

> é»˜è®¤ä»…ç»‘å®šæœ¬åœ°å›ç¯åœ°å€

è®¿é—® `http://localhost:8041` å³å¯ä½¿ç”¨ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
yewtrack/
â”œâ”€â”€ backend/                      # åç«¯æœåŠ¡ï¼ˆExpress + TypeScriptï¼‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ config.ts             # é…ç½®ä¸­å¿ƒï¼ˆç¯å¢ƒå˜é‡è§£æã€é»˜è®¤å€¼ï¼‰
â”‚   â”‚   â”œâ”€â”€ main.ts               # Express åº”ç”¨å…¥å£ï¼ˆè·¯ç”±ã€ä¸­é—´ä»¶ï¼‰
â”‚   â”‚   â”œâ”€â”€ models/               # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ message.ts        # Message æ¥å£å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ scripts/              # ç»´æŠ¤è„šæœ¬
â”‚   â”‚   â”‚   â”œâ”€â”€ mediaProcessor.ts    # åª’ä½“å¤„ç†å·¥å…·
â”‚   â”‚   â”‚   â””â”€â”€ migrateToJsonl.ts    # æ•°æ®è¿ç§»è„šæœ¬
â”‚   â”‚   â””â”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚   â”‚       â”œâ”€â”€ jsonlManager.ts   # JSONL æ–‡ä»¶è¯»å†™æ“ä½œ
â”‚   â”‚       â””â”€â”€ cleanupManager.ts # è‡ªåŠ¨æ¸…ç†ä»»åŠ¡ç®¡ç†
â”‚   â”œâ”€â”€ data/                     # åç«¯æ•°æ®ç›®å½•ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
â”‚   â”‚   â”œâ”€â”€ messages.jsonl        # æ¶ˆæ¯å­˜å‚¨æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ files/                # ä¸Šä¼ çš„æ–‡ä»¶
â”‚   â”‚       â”œâ”€â”€ original/         # åŸå§‹æ–‡ä»¶
â”‚   â”‚       â””â”€â”€ preview/          # é¢„è§ˆæ–‡ä»¶ï¼ˆæœªæ¥åŠŸèƒ½ï¼‰
â”‚   â”œâ”€â”€ Dockerfile                # åç«¯å®¹å™¨æ„å»ºæ–‡ä»¶
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ pnpm-lock.yaml
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ frontend/                     # å‰ç«¯åº”ç”¨ï¼ˆVue 3 + Viteï¼‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.vue               # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ main.ts               # åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ style.css             # å…¨å±€æ ·å¼
â”‚   â”‚   â”œâ”€â”€ components/           # Vue ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ TopBar.vue        # é¡¶éƒ¨å·¥å…·æ ï¼ˆæ ‡é¢˜ã€åˆ·æ–°æŒ‰é’®ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ MessageList.vue   # æ¶ˆæ¯åˆ—è¡¨ï¼ˆæ»šåŠ¨ã€åˆ†ç»„ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ InputBar.vue      # åº•éƒ¨è¾“å…¥æ ï¼ˆæ–‡æœ¬ã€æ–‡ä»¶ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ ImagePreview.vue  # å›¾ç‰‡é¢„è§ˆç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ VideoPreview.vue  # è§†é¢‘é¢„è§ˆç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ HelloWorld.vue    # ç¤ºä¾‹ç»„ä»¶ï¼ˆå¯åˆ é™¤ï¼‰
â”‚   â”‚   â”œâ”€â”€ types/                # TypeScript ç±»å‹
â”‚   â”‚   â”‚   â””â”€â”€ message.ts        # Message ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚   â”‚       â”œâ”€â”€ deviceId.ts       # è®¾å¤‡ ID ç”Ÿæˆå’Œç®¡ç†
â”‚   â”‚       â””â”€â”€ api.ts            # API URL æ„å»ºå·¥å…·
â”‚   â”œâ”€â”€ public/                   # é™æ€èµ„æº
â”‚   â”œâ”€â”€ Dockerfile                # å‰ç«¯å®¹å™¨æ„å»ºæ–‡ä»¶
â”‚   â”œâ”€â”€ nginx.conf.template       # Nginx é…ç½®æ¨¡æ¿
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ vite.config.ts            # Vite é…ç½®
â”‚   â”œâ”€â”€ tailwind.config.js        # Tailwind CSS é…ç½®
â”‚   â”œâ”€â”€ postcss.config.js
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ pnpm-lock.yaml
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ data/                         # æ•°æ®ç›®å½•ï¼ˆç”Ÿäº§ç¯å¢ƒï¼Œgit å·²å¿½ç•¥ï¼‰
â”‚   â”œâ”€â”€ messages.jsonl            # æ¶ˆæ¯å­˜å‚¨æ–‡ä»¶
â”‚   â””â”€â”€ files/                    # ä¸Šä¼ çš„æ–‡ä»¶
â”‚       â”œâ”€â”€ original/             # åŸå§‹æ–‡ä»¶
â”‚       â””â”€â”€ preview/              # é¢„è§ˆæ–‡ä»¶
â”‚
â”œâ”€â”€ docker-compose.yml            # Docker Compose ç¼–æ’é…ç½®
â”œâ”€â”€ .env                          # ç¯å¢ƒå˜é‡é…ç½®ï¼ˆgit å·²å¿½ç•¥ï¼‰
â”œâ”€â”€ .env.production               # ç”Ÿäº§ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ .env.development              # å¼€å‘ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ LICENSE                      
â””â”€â”€ README.md
```

## âš™ï¸ é…ç½®è¯´æ˜

é›†æˆåœ¨æ ¹ç›®å½•ä¸‹çš„.envæ–‡ä»¶

å…ˆæ‰§è¡Œ
`
cp .env.production .env
`
æˆ–è€…
`
cp .env.development .env
`
- .env.development - å¼€å‘ç¯å¢ƒé…ç½®
- .env.production - ç”Ÿäº§ç¯å¢ƒé…ç½®

> å‰ç«¯é…ç½®è¯»å–é€»è¾‘åœ¨ `frontend/vite.config.ts` å’Œ `frontend/src/utils/api.ts`
> åç«¯é…ç½®è¯»å–é€»è¾‘åœ¨ `backend/src/config.ts`

## ğŸ”Œ API ç«¯ç‚¹

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/api/messages` | è·å–æ‰€æœ‰æ¶ˆæ¯ |
| POST | `/api/messages` | å‘é€æ–‡æœ¬æ¶ˆæ¯ |
| POST | `/api/upload` | ä¸Šä¼ æ–‡ä»¶ |
| GET | `/api/files/:filename` | è®¿é—®ä¸Šä¼ çš„æ–‡ä»¶ |
| GET | `/api/download/:id` | ä¸‹è½½æ–‡ä»¶ï¼ˆå¸¦åŸå§‹æ–‡ä»¶åï¼‰ |
| DELETE | `/api/messages/:id` | åˆ é™¤æ¶ˆæ¯ |

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**: Vue 3 (Composition API)
- **æ„å»ºå·¥å…·**: Vite 7
- **æ ·å¼**: Tailwind CSS 3
- **ç±»å‹**: TypeScript 5
- **HTTP æœåŠ¡**: Nginx (ç”Ÿäº§ç¯å¢ƒ)

### åç«¯
- **æ¡†æ¶**: Express 5
- **è¿è¡Œæ—¶**: Node.js 20
- **ç±»å‹**: TypeScript 5
- **æ–‡ä»¶ä¸Šä¼ **: Multer 2
- **å­˜å‚¨æ ¼å¼**: JSONL (JSON Lines)

### DevOps
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **åŒ…ç®¡ç†**: pnpm (workspace)
- **å¼€å‘å·¥å…·**: ts-node-dev (çƒ­é‡è½½)

## ğŸ“ å¼€å‘æŒ‡å—

### Git æäº¤è§„èŒƒ

æœ¬é¡¹ç›®ä½¿ç”¨çº¦å®šå¼æäº¤ï¼ˆConventional Commitsï¼‰ï¼š

```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤ Bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: å·¥å…·æ›´æ–°
build: æ„å»ºå·¥å…·æ›´æ–°
```

## ğŸ“„ è®¸å¯è¯

MIT License Â© 2025 YewFence